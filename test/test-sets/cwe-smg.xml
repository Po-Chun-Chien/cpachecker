<?xml version="1.0"?>

<!--
This file is part of CPAchecker,
a tool for configurable software verification:
https://cpachecker.sosy-lab.org

SPDX-FileCopyrightText: 2007-2021 Dirk Beyer <https://www.sosy-lab.org>

SPDX-License-Identifier: Apache-2.0
-->

<!--
INFO:
This benchmark verifies the given tasks with the property that matches the corresponding CWE-Id
for memory properties and we apply SMG analysis for it.
We expect a small runtime and memory usage per run and define the limits smaller that in SV-COMP.
-->

<!DOCTYPE benchmark PUBLIC "+//IDN sosy-lab.org//DTD BenchExec benchmark 1.0//EN" "http://www.sosy-lab.org/benchexec/benchmark-1.0.dtd">
<benchmark tool="cpachecker" timelimit="60 s" hardtimelimit="90 s" memlimit="5 GB" cpuCores="2">
  <option name="-heap">4500M</option>
  <option name="-noout"/>
  <option name="-benchmark"/>

  <!-- SV-Comp files assume that malloc always succeeds -->
  <option name="-setprop">cpa.predicate.memoryAllocationsAlwaysSucceed=true</option>

<rundefinition name="SMG">
  <option name="-svcomp21--memorysafety"/>
    <tasks name="CWE121_Stack_Based_Buffer_Overflow">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE121_Stack_Based_Buffer_Overflow.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE122_Heap_Based_Buffer_Overflow">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE122_Heap_Based_Buffer_Overflow.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE124_Buffer_Underwrite">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE124_Buffer_Underwrite.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE126_Buffer_Overread">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE126_Buffer_Overread.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE127_Buffer_Underread">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE127_Buffer_Underread.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE401_Memory_Leak">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE401_Memory_Leak.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE415_Double_Free">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE415_Double_Free.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE416_Use_After_Free">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE416_Use_After_Free.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE476_NULL_Pointer_Dereference">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE476_NULL_Pointer_Dereference.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE590_Free_Memory_Not_on_Heap">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE590_Free_Memory_Not_on_Heap.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE761_Free_Pointer_Not_at_Start_of_Buffer">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE761_Free_Pointer_Not_at_Start_of_Buffer.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE789_Uncontrolled_Mem_Alloc">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE789_Uncontrolled_Mem_Alloc.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE843_Type_Confusion">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE843_Type_Confusion.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
</rundefinition>
  
</benchmark>
