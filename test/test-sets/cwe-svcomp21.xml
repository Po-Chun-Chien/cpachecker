<?xml version="1.0"?>

<!--
This file is part of CPAchecker,
a tool for configurable software verification:
https://cpachecker.sosy-lab.org

SPDX-FileCopyrightText: 2007-2021 Dirk Beyer <https://www.sosy-lab.org>

SPDX-License-Identifier: Apache-2.0
-->

<!--
INFO:
This benchmark verifies the given tasks with the default property of SV-COMP.
CPAchecker chooses the corresponding analysis for overflow analysis (with an SMT-based analysis) or memory analysis (via SMG analysis).
We expect a small runtime and memory usage per run and define the limits smaller that in SV-COMP.
-->

<!DOCTYPE benchmark PUBLIC "+//IDN sosy-lab.org//DTD BenchExec benchmark 1.0//EN" "http://www.sosy-lab.org/benchexec/benchmark-1.0.dtd">
<benchmark tool="cpachecker" timelimit="900 s" hardtimelimit="930 s" memlimit="5 GB" cpuCores="2">
  <option name="-heap">4500M</option>
  <option name="-noout"/>
  <option name="-benchmark"/>

  <!-- SV-Comp files assume that malloc always succeeds -->
  <option name="-setprop">cpa.predicate.memoryAllocationsAlwaysSucceed=true</option>

<rundefinition name="SV-COMP">
  <option name="-svcomp21"/>
  <tasks name="CWE190_Integer_Overflow">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE190_Integer_Overflow.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/no-overflow.prp</propertyfile>
  </tasks>
  <tasks name="CWE191_Integer_Underflow">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE191_Integer_Underflow.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/no-overflow.prp</propertyfile>
  </tasks>
  <tasks name="CWE401_Memory_Leak">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE401_Memory_Leak.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE415_Double_Free">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE415_Double_Free.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE416_Use_After_Free">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE416_Use_After_Free.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
  <tasks name="CWE843_Type_Confusion">
    <includesfile>../programs/benchmarks/Juliet_Test/Juliet_Test_Suite_v1.3_for_C_Cpp/C/set-files/CWE843_Type_Confusion.set</includesfile>
    <propertyfile>../programs/benchmarks/properties/valid-memsafety.prp</propertyfile>
  </tasks>
</rundefinition>
  
</benchmark>
